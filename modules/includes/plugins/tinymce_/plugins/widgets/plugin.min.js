
tinymce.PluginManager.add("widgets",function(c,b){function a(){var h;var l=c.selection;var e;function f(){var o=[{text:"2",value:"1"}];var m=new XMLHttpRequest();var n=b+"../../../../../../views/ajax/getWidgetsForTinyMCE.php";m.onreadystatechange=function(){if(m.readyState===4&&m.status===200){var p=JSON.parse(m.responseText);var q=[];var r;for(r=0;r<p.length;r++){var s={};s.text=p[r].text;s.value=p[r].value;q.push(s)}o=p;return o}};m.open("GET",n,false);m.send();return o}var i={type:"listbox",name:"widget_select",label:"Select Widget",values:f()};var k={type:"textbox",name:"widget_condition",label:"Conditions"};e=l.getNode();var g=e.innerText;var d=g.match("##wid_id_start##(.*)##wid_id_end##");if(d!==undefined&&d!==null){i.value=d[1]}var j=g.match("##wid_con_start##(.*)##wid_con_end##");if(j!==undefined&&j!==null){k.value=j[1]}h=c.windowManager.open({autoScroll:true,width:500,height:130,top:10,title:"Widgets",spacing:20,padding:10,body:[i,k],onsubmit:function(n){if(n.data.widget_select!==undefined&&n.data.widget_select!==""){var o="##wid_con_start##"+n.data.widget_condition+"##wid_con_end##"}var m="<span class='mceNonEditable'>##wid_start####wid_id_start##"+n.data.widget_select+"##wid_id_end##"+o+"##wid_end##</span><p></p>";c.insertContent(m)}})}c.addButton("widgets",{text:"Widgets",tooltip:"Widgets",onclick:a,stateSelector:'span[class="mceNonEditable"]'})});